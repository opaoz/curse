<!doctype html>
<html lang="ru" ng-app="App">
<head>
    <meta charset="UTF-8">
    <title>Map</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.0/animate.min.css">
    <link rel="stylesheet" href="bower_components/seiyria-bootstrap-slider/dist/css/bootstrap-slider.css">
    <link rel="stylesheet" href="style/main.css"/>
    <style>
        html, body {
            height: 100%;
            width: 100%;
        }

        .input-group {
            margin: 5px 0;
        }
    </style>
</head>
<body ng-controller="MainController as vm" ng-init="vm._init_()">
<div class="container">
    <div class="row">
        <div class="col-xs-4">
            <div class="input-group">
                <span class="input-group-addon" id="basic-addon1"><i class="glyphicon glyphicon-search"></i></span>
                <input type="text" class="form-control" ng-model="vm.searchString" placeholder="Саратов">
            </div>
        </div>
        <div class="col-xs-8" style="line-height: 43px;">
            <div class="row">
                <div class="col-xs-1 year-label">{{vm.minYear}}</div>
                <div class="col-xs-10">
                    <slider ng-model="vm.year" step="1" range="true" slider-tooltip-position="bottom" min="vm.minYear"
                            max="vm.MAX_YEAR" value="Year"
                            tooltip="show"></slider>
                </div>
                <div class="col-xs-1 year-label">{{vm.MAX_YEAR}}</div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <map center="{{vm.map.center | LonLat}}" zoom="{{vm.map.zoom}}" class="map">
                <custom-marker ng-repeat="mark in vm.markers track by $index"
                               id="custom-marker-{{$index}}"
                               on-click="vm.clickOnMarker($index)"
                               position="{{mark.max.pos}}">
                    <div>
                        <span class="circle"></span> {{mark.max.name}}
                    </div>
                </custom-marker>
            </map>
            <a class="btn-export" ng-click="vm.downloadCSV()"><i class="glyphicon glyphicon-save"
                                                                 title="Скачать отчёт"></i></a>
            <a animated-modal options="vm.options" after-close="vm.afterClose()" before-open="vm.beforeOpen()"
               href="#play" class="btn-play"><i
                    class="glyphicon glyphicon-play"
                    title="Начать демонстрацию"></i></a>
        </div>
    </div>
    <pageslide ps-open="vm.pageslide"
               ps-click-outside="false"
               ps-key-listener="true">
        <div class="row more-info">
            <div class="col-xs-12">
                <h1>{{vm.selected.max.name}}</h1>
                <p>{{vm.selected.max.desc}}</p>
                <p ng-if="vm.selected.max.type"><b>Тип:</b> {{vm.selected.max.type.join(', ')}}</p>
                <p ng-if="vm.selected.max.nearest"><b>Близлежащие объекты:</b> {{vm.selected.max.nearest.join(', ')}}
                </p>
                <p><b>Годы существования:</b> {{vm.selected.max.minYear + ' - ' + vm.selected.max.maxYear}}</p>
                <p><b>Координаты:</b> {{vm.selected.max.pos.join(', ')}}</p>
                <p ng-if="vm.selected.array.length>1"><b>Сопутствующие названия:</b>
                    <a ng-repeat="ps in vm.selected.array track by $index"
                       style="cursor: pointer;"
                       ng-click="vm.selected.max=ps" ng-if="ps.name!==vm.selected.max.name">{{ps.name}}</a>
                </p>
            </div>
        </div>
        <a ng-click="vm.pageslide=false" class="close-btn"><i class="glyphicon glyphicon-remove"></i></a>
    </pageslide>
    <div class="row">
        <div class="col-xs-12">
            <div style="background: #eee;padding:5px 0;" class="clearfix">
                <div class="col-xs-4">
                    <div class="text-center h4 cp check-block" style="display:block;">
                        Тип
                    </div>
                    <div ng-repeat="(k,v) in vm.types track by $index" class="animate">
                        <label>
                            <checkbox ng-model="vm.types[k]"></checkbox>
                            {{k}}
                        </label>
                    </div>
                </div>
                <div class="col-xs-4">
                    <div class="text-center h4 cp check-block2" style="display:block;">
                        Объекты культуры
                    </div>
                    <div ng-repeat="(k,v) in vm.objects track by $index" class="animate">
                        <label>
                            <checkbox ng-model="vm.objects[k]"></checkbox>
                            {{k}}
                        </label>
                    </div>
                </div>
                <div class="col-xs-4">
                    <div class="text-center h4 cp check-block" style="display:block;">
                        Близлежащие природные объекты
                    </div>
                    <div ng-repeat="(k,v) in vm.nearest track by $index" class="animate">
                        <label>
                            <checkbox ng-model="vm.nearest[k]"></checkbox>
                            {{k}}
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="play">
    <div class="close-play">
        <i class="glyphicon glyphicon-remove-circle"></i>
    </div>
    <div class="modal-content">
        <map center="{{vm.map.center | LonLat}}" zoom="{{vm.map.zoom}}" class="map">
            <custom-marker ng-repeat="mark in vm.demo track by $index"
                           id="custom-marker-preview-{{$index}}"
                           ng-if="mark.show"
                           position="{{mark.pos}}">
                <div>
                    <span class="circle"></span> {{mark.name}}
                </div>
            </custom-marker>
        </map>
        <div class="current-year">
            <h2>
                <counter value="vm.currentYear"
                         to="vm.manualStart"
                         duration="(vm.MAX_YEAR-vm.minYear)*200"
                         step="vm.step()"> {{vm.currentYear | myNumber}}
                </counter>
            </h2>
        </div>
    </div>
</div>

<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="bower_components/lodash/lodash.js"></script>
<script src="bower_components/angular/angular.js"></script>
<script src="//maps.google.com/maps/api/js"></script>
<script src="bower_components/ngmap/build/scripts/ng-map.js"></script>
<script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
<script src="bower_components/seiyria-bootstrap-slider/dist/bootstrap-slider.js"></script>
<script src="bower_components/angular-bootstrap-slider/slider.js"></script>
<script src="bower_components/angular-bootstrap-checkbox/angular-bootstrap-checkbox.js"></script>
<script src="bower_components/angular-pageslide-directive/dist/angular-pageslide-directive.js"></script>
<script src="bower_components/angular-animate/angular-animate.min.js"></script>
<script src="js/libs/animatedModal.min.js"></script>
<script src="js/libs/angular-animated-modal.js"></script>
<script src="js/libs/angular-counter/js/angular-counter.js"></script>

<script src="js/app.js"></script>
<!--Controllers-->
<script src="js/controllers/main.js"></script>

<!--Services-->
<script src="js/services/http-request.js"></script>
<script src="js/services/lodash.js"></script>
<script src="js/services/simple-tmpl.js"></script>
<script src="js/services/excel.js"></script>

<!--Filters-->
<script src="js/filters/code-formatter.js"></script>
<script src="js/filters/trust-source.js"></script>
<script src="js/filters/lon-lat-formatter.js"></script>
<script src="js/filters/number.js"></script>
</body>
</html>