<!doctype html>
<html lang="ru" ng-app="App">
<head>
    <meta charset="UTF-8">
    <title>Map</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.0/animate.min.css">
    <link rel="stylesheet" href="bower_components/seiyria-bootstrap-slider/dist/css/bootstrap-slider.css">
    <link rel="stylesheet" href="style/main.css"/>
    <style>
        html, body {
            height: 100%;
            width: 100%;
        }

        .input-group {
            margin: 5px 0;
        }
    </style>
</head>
<body ng-controller="MainController as vm" ng-init="vm._init_()">
<div class="container-fluid" style="padding-bottom:50px;">
    <a ng-if="!vm.demonstration" class="menu-button" ng-click="vm.menu=true" ng-class="{'m':vm.menu}"><i
            class="glyphicon glyphicon-menu-hamburger"></i></a>
    <div class="page-header" id="map">
        <h1>Историческая интерактивная карта поселений Саратовской области</h1>
    </div>
    <div class="row">
        <div class="col-xs-4">
            <div class="input-group">
                <span class="input-group-addon" id="basic-addon1"><i class="glyphicon glyphicon-search"></i></span>
                <input type="text" class="form-control" ng-model="vm.searchString" placeholder="Саратов">
            </div>
        </div>
        <div class="col-xs-4 col-sm-6" style="line-height: 43px;">
            <div class="row">
                <div class="col-xs-1 year-label">{{vm.minYear}}</div>
                <div class="col-xs-10">
                    <slider ng-model="vm.year" step="1" range="true" slider-tooltip-position="bottom" min="vm.minYear"
                            max="vm.MAX_YEAR" value="Year"
                            tooltip="show"></slider>
                </div>
                <div class="col-xs-1 year-label">{{vm.MAX_YEAR}}</div>
            </div>
        </div>
        <div class="col-xs-4 col-sm-2">
            <div class="row">
                <div class="col-xs-12">
                    <div class="input-group">
                        <span class="input-group-addon">Год: </span>
                        <input type="text" class="form-control" ng-model="vm.exactYear" placeholder="1996">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <map center="{{vm.map.center | LonLat}}" zoom="{{vm.map.zoom}}" class="map">
                <custom-marker ng-repeat="mark in vm.markers track by $index"
                               id="custom-marker-{{$index}}"
                               on-click="vm.clickOnMarker($index)"
                               position="{{mark.max.pos}}">
                    <div>
                        <span class="circle"></span> {{mark.max.name}}
                    </div>
                </custom-marker>
            </map>
        </div>
    </div>
    <pageslide ps-open="vm.pageslide"
               ps-side="left"
               ps-size="400px"
               ps-click-outside="false"
               ps-key-listener="true">
        <div class="row more-info">
            <div class="col-xs-12" id="word-export">
                <h1>{{vm.selected.max.name}}</h1>
                <p>{{vm.selected.max.desc}}</p>
                <p ng-if="vm.selected.max.type"><b>Тип:</b> {{vm.selected.max.type.join(', ')}}</p>
                <p ng-if="vm.selected.max.nearest"><b>Близлежащие объекты:</b> {{vm.selected.max.nearest.join(', ')}}
                </p>
                <p><b>Годы существования:</b> {{vm.selected.max.minYear + ' - ' + vm.selected.max.maxYear}}</p>
                <p><b>Координаты:</b> {{vm.selected.max.pos.join(', ')}}</p>
                <p ng-if="vm.selected.array.length>1"><b>Сопутствующие названия:</b>
                    <a ng-repeat="ps in vm.selected.array track by $index"
                       style="cursor: pointer;"
                       ng-click="vm.selected.max=ps" ng-if="ps.name!==vm.selected.max.name">{{ps.name}}</a>
                </p>
            </div>
            <div class="text-center" style="background: white;">
                <a ng-click="vm.word(vm.selected.max.name)" class="btn btn-default"><i
                        class="glyphicon glyphicon-save"></i>
                    Экспорт в Word</a>
            </div>
        </div>
        <a ng-click="vm.pageslide=false" class="close-btn"><i class="glyphicon glyphicon-remove"></i></a>
    </pageslide>
    <pageslide ps-open="vm.menu"
               ps-key-listener="true">
        <div class="row ps-menu">
            <div class="col-xs-12">
                <h3 style="color:white;">Меню</h3>
                <hr style="color:white;">

                <a href="#map"><i class="glyphicon glyphicon-map-marker"></i> Карта</a>
                <a href="#howto"><i class="glyphicon glyphicon-question-sign"></i> Как пользоваться?</a>
                <a href="#about"><i class="glyphicon glyphicon-info-sign"></i> О сайте</a>
            </div>
        </div>
        <div class="ps-footer">
            &copy; 2016 год<br>
            СГТУ, Левин В.Е, Шульга Т.Э.
        </div>
        <a ng-click="vm.menu=false" class="close-btn"><i class="glyphicon glyphicon-remove"></i></a>
    </pageslide>

    <div class="row">
        <div class="col-xs-12">
            <a animated-modal options="vm.options" after-close="vm.afterClose()" before-open="vm.beforeOpen()"
               href="#play" class="btn btn-default btn-custom"><i class="glyphicon glyphicon-play"></i> Начать
                демонстрацию
            </a>
            <a ng-click="vm.downloadCSV()" class="btn btn-default btn-custom"><i
                    class="glyphicon glyphicon-save"></i>
                Экспорт видимых
            </a>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <div style="background: #eee;padding:5px 0;" class="clearfix">
                <div class="col-xs-4">
                    <div class="text-center h4 cp check-block" style="display:block;">
                        Тип
                    </div>
                    <div ng-repeat="(k,v) in vm.types track by $index" class="animate">
                        <label>
                            <checkbox ng-model="vm.types[k]"></checkbox>
                            {{k}}
                        </label>
                    </div>
                </div>
                <div class="col-xs-4">
                    <div class="text-center h4 cp check-block2" style="display:block;">
                        Объекты культуры
                    </div>
                    <div ng-repeat="(k,v) in vm.objects track by $index" class="animate">
                        <label>
                            <checkbox ng-model="vm.objects[k]"></checkbox>
                            {{k}}
                        </label>
                    </div>
                </div>
                <div class="col-xs-4">
                    <div class="text-center h4 cp check-block" style="display:block;">
                        Близлежащие природные объекты
                    </div>
                    <div ng-repeat="(k,v) in vm.nearest track by $index" class="animate">
                        <label>
                            <checkbox ng-model="vm.nearest[k]"></checkbox>
                            {{k}}
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="page-header" id="howto">
        <h2>Как пользоваться?</h2>
    </div>
    <div class="row howto">
        <div class="col-xs-12">
            <strong>Временные границы</strong>
            <p>Основным критерием выборки при работе с данным инструментом является выбор временных границ.
                Выбор осуществляется посредством двух инструментов:</p>
            <ul>
                <li><strong>Timeline (временная линия)</strong></li>
                <li><strong>Поле ввода конкретного года</strong></li>
            </ul>

            <p>На <i>рисунке 1</i> представлена детальная схема временной линии.</p>

            <strong>Timeline</strong>
            <div class="text-center">
                <img src="https://github.com/opaoz/curse/blob/master/app/images/1.png?raw=true" alt="Timeline scheme"
                     class="img-responsive">
                <p><strong>Рисунок 1 - </strong><i>Детальная схема временной линии</i></p>
            </div>

            <p>Цифрами <strong class="blue">II</strong> и <strong class="blue">III</strong> на схеме обозначены общие
                временные границы - от минимального года, представленного в базе, до текущего календарного года.
                Наприменр, в выборке, представленной на схеме самым первым поселением является город Саратов (основан в
                1590 году), поэтому строка <strong class="blue">II</strong> имеет значение <strong>1590</strong>.
            </p>

            <p>Цифрой <strong class="red">I</strong> обозначена сама временная линия. Она представляет собой
                двусторонний слайдер, позволяющий задавать временные границы, пользуясь "ползунками" <strong
                        class="purple">IV</strong> и <strong class="purple">V</strong>
                При перемещении "ползунков" <i>(например, рисунок 2)</i> выделенный интервал, применяемый к карте,
                выделен <strong class="marked">синим цветом</strong>, а промежутки, оставшиеся за пределами интервала и
                не влияющие на выборку данных, <strong class="unmarked">красным</strong>.</p>

            <div class="text-center">
                <img src="https://github.com/opaoz/curse/blob/master/app/images/2.png?raw=true" alt="Timeline"
                     class="img-responsive">
                <p><strong>Рисунок 2 - </strong><i>Изменённое состояние временной линии</i></p>
            </div>

            <strong>Поле ввода конкретного года</strong>
            <p>Если при осуществелении выборки не нужен интервал, а нужен конкретный год, либо общий интервал слишком
                велик и не удобен для осуществления выборки с использованием ползунков, можно использовать поле, для
                ввода значения требуемого года. Поле ввода обозначено на <i>рисунке 3</i> цифрой <strong
                        class="green">I</strong></p>

            <div class="text-center">
                <img src="https://github.com/opaoz/curse/blob/master/app/images/3.png?raw=true" alt="Input year"
                     class="img-responsive">
                <p><strong>Рисунок 3 - </strong><i>Поле для ввода конкретного года</i></p>
            </div>

            <p>Сразу же после ввода корректного* значения года, интервал сузится до этого значения и выборка,
                представленная на карте, также изменится в соответствии с новой временной границей (рисунок 4)</p>

            <div class="text-center">
                <img src="https://github.com/opaoz/curse/blob/master/app/images/4.png?raw=true" alt="Input year changed"
                     class="img-responsive">
                <p><strong>Рисунок 4 - </strong><i>Изменение временного промежутка после ввода года</i></p>
            </div>

            <p class="mark">*Корректным считает целочисленное значение, в формате года (4 цифры), подпадающее под общие
                временные границы (т.е. являющееся больше или равно минимального и меньше или равно максимального)</p>
        </div>
    </div>

    <div class="page-header" id="about">
        <h2>О сайте</h2>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <strong>О проекте</strong>
            <p>На территории Саратовской области на протяжении всей ее истории существовало множество национальных
                поселений. Некоторые из них уже исчезли, другие переименованы, третьи перенесены на другое место.
                Информация об этих поселениях представляют огромную ценность для историков и этнографов, но найти ее
                можно только в архивах или в немногочисленных разрозненных публикациях разных лет</p>
            <p>Главной <strong>целью</strong> проекта <strong>«Историческая интерактивная карта поселений Саратовской
                области»</strong> является создание инструмента для простой и наглядной работы с
                архивными данными, а
                также создание отчётов, на основе результатов работы</p>
            <hr>
            <strong>О технологиях</strong>
            <p>При разработке данного сайта использовались современные технологии <strong>FrontEnd</strong> разработки.
                Такие как <strong>AngularJs, Bootstrap, jQuery</strong>.</p>
            <p>В основе серверной состовляющей лежит фреймворк <strong>Jena</strong>, позволяющий использовать в данном
                проекте
                <strong>онтологический подход</strong> к хранению данных, что существенно расширяет возможности
                взаимодействия с
                данными</p>
            <hr>
            <strong>Об авторах</strong>
            <p>Проект <strong>«Историческая интерактивная карта поселений Саратовской области»</strong> разрабатывается
                студентом кафедры <strong>«Прикладная информатика и программная инженерия»</strong> в качестве
                дипломного проекта«, совместно с кафедрой <strong>«История Отечества и культуры»</strong></p>
        </div>
    </div>
</div>

<div id="play">
    <div class="close-play">
        <i class="glyphicon glyphicon-remove-circle"></i>
    </div>
    <div class="modal-content">
        <map center="{{vm.map.center | LonLat}}" zoom="{{vm.map.zoom}}" class="map">
            <custom-marker ng-repeat="mark in vm.demo track by $index"
                           id="custom-marker-preview-{{$index}}"
                           ng-if="mark.show"
                           position="{{mark.pos}}">
                <div>
                    <span class="circle"></span> {{mark.name}}
                </div>
            </custom-marker>
        </map>
        <div class="current-year">
            <h2>
                <counter value="vm.currentYear"
                         to="vm.manualStart"
                         duration="(vm.MAX_YEAR-vm.minYear)*200"
                         step="vm.step()"> {{vm.currentYear | myNumber}}
                </counter>
            </h2>
        </div>
    </div>
</div>

<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="bower_components/lodash/lodash.js"></script>
<script src="bower_components/angular/angular.js"></script>
<script src="//maps.google.com/maps/api/js"></script>
<script src="bower_components/ngmap/build/scripts/ng-map.js"></script>
<script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
<script src="bower_components/file-saver/FileSaver.min.js"></script>
<script src="bower_components/seiyria-bootstrap-slider/dist/bootstrap-slider.js"></script>
<script src="bower_components/angular-bootstrap-slider/slider.js"></script>
<script src="bower_components/angular-bootstrap-checkbox/angular-bootstrap-checkbox.js"></script>
<script src="bower_components/angular-pageslide-directive/dist/angular-pageslide-directive.js"></script>
<script src="bower_components/angular-animate/angular-animate.min.js"></script>
<script src="js/libs/animatedModal.min.js"></script>
<script src="bower_components/tableexport.js/dist/js/tableexport.js"></script>
<script src="js/libs/angular-animated-modal.js"></script>
<script src="js/libs/angular-counter/js/angular-counter.js"></script>

<script src="js/app.js"></script>
<!--Controllers-->
<script src="js/controllers/main.js"></script>

<!--Services-->
<script src="js/services/http-request.js"></script>
<script src="js/services/lodash.js"></script>
<script src="js/services/simple-tmpl.js"></script>
<script src="js/services/word.js"></script>
<script src="js/services/excel.js"></script>

<!--Filters-->
<script src="js/filters/code-formatter.js"></script>
<script src="js/filters/trust-source.js"></script>
<script src="js/filters/lon-lat-formatter.js"></script>
<script src="js/filters/number.js"></script>
</body>
</html>